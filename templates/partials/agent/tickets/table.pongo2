{# Ticket List Table Partial with Synthwave Styling #}
{# Required variables: Tickets, CurrentFilters #}

<div class="overflow-x-auto">
    <table class="gk-table w-full">
        <thead>
            <tr>
                <th class="w-8 px-1 py-2 text-left">
                    <input type="checkbox" id="select-all" class="rounded">
                </th>
                <th class="px-2 py-2 text-left whitespace-nowrap">
                    <a href="?sort=tn&order={% if CurrentFilters.sort == 'tn' and CurrentFilters.order == 'asc' %}desc{% else %}asc{% endif %}&{{ request.GET.urlencode }}"
                       class="text-xs font-medium uppercase tracking-wider gk-link-neon">
                        {{ t("tickets.ticket_number")|default:"Ticket #" }}
                        {% if CurrentFilters.sort == 'tn' %}
                            {% if CurrentFilters.order == 'asc' %}↑{% else %}↓{% endif %}
                        {% endif %}
                    </a>
                </th>
                <th class="px-2 py-2 text-left w-full">
                    <a href="?sort=title&order={% if CurrentFilters.sort == 'title' and CurrentFilters.order == 'asc' %}desc{% else %}asc{% endif %}&{{ request.GET.urlencode }}"
                       class="text-xs font-medium uppercase tracking-wider gk-link-neon">
                        {{ t("tickets.title")|default:"Tickets" }}
                        {% if CurrentFilters.sort == 'title' %}
                            {% if CurrentFilters.order == 'asc' %}↑{% else %}↓{% endif %}
                        {% endif %}
                    </a>
                </th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap" style="color: var(--gk-text-muted);">
                    {{ t("tickets.customer")|default:"Customer" }}
                </th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap" style="color: var(--gk-text-muted);">
                    {{ t("tickets.queue")|default:"Queue" }}
                </th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap" style="color: var(--gk-text-muted);">
                    {{ t("tickets.state")|default:"State" }}
                </th>
                <th class="px-2 py-2 text-left whitespace-nowrap">
                    <a href="?sort=priority&order={% if CurrentFilters.sort == 'priority' and CurrentFilters.order == 'asc' %}desc{% else %}asc{% endif %}&{{ request.GET.urlencode }}"
                       class="text-xs font-medium uppercase tracking-wider gk-link-neon">
                        {{ t("tickets.priority_short")|default:"Prio" }}
                        {% if CurrentFilters.sort == 'priority' %}
                            {% if CurrentFilters.order == 'asc' %}↑{% else %}↓{% endif %}
                        {% endif %}
                    </a>
                </th>
                <th class="px-2 py-2 text-left text-xs font-medium uppercase tracking-wider whitespace-nowrap" style="color: var(--gk-text-muted);">
                    {{ t("tickets.assigned")|default:"Assigned" }}
                </th>
                <th class="px-2 py-2 text-left whitespace-nowrap">
                    <a href="?sort=create_time&order={% if CurrentFilters.sort == 'create_time' and CurrentFilters.order == 'asc' %}desc{% else %}asc{% endif %}&{{ request.GET.urlencode }}"
                       class="text-xs font-medium uppercase tracking-wider gk-link-neon">
                        {{ t("tickets.age")|default:"Age" }}
                        {% if CurrentFilters.sort == 'create_time' %}
                            {% if CurrentFilters.order == 'asc' %}↑{% else %}↓{% endif %}
                        {% endif %}
                    </a>
                </th>
                <th class="w-6 px-1 py-2 text-center text-xs font-medium uppercase tracking-wider whitespace-nowrap" style="color: var(--gk-text-muted);">
                    #
                </th>
                <th class="w-12 px-1 py-2 text-right text-xs font-medium uppercase tracking-wider whitespace-nowrap" style="color: var(--gk-text-muted);">
                    {{ t("common.actions")|default:"Actions" }}
                </th>
            </tr>
        </thead>
        <tbody>
            {% for ticket in Tickets %}
            <tr>
                <td class="px-1 py-2">
                    <input type="checkbox" class="ticket-select rounded" value="{{ ticket.id }}">
                </td>
                <td class="px-2 py-2">
                    <a href="/ticket/{{ ticket.tn }}" class="gk-link-neon font-medium text-sm">
                        #{{ ticket.tn }}
                    </a>
                </td>
                <td class="px-2 py-2 w-full">
                    <div class="text-sm" style="color: var(--gk-text-primary);">
                        {{ ticket.title }}
                    </div>
                </td>
                <td class="px-2 py-2 whitespace-nowrap">
                    <div class="text-sm" style="color: var(--gk-text-primary);">
                        {{ ticket.customer|default:"-" }}{% if ticket.company %} <span style="color: var(--gk-text-muted);">({{ ticket.company }})</span>{% endif %}
                    </div>
                </td>
                <td class="px-2 py-2 whitespace-nowrap">
                    <div class="text-sm" style="color: var(--gk-text-primary);">
                        {{ ticket.queue }}
                    </div>
                </td>
                <td class="px-2 py-2">
                    <span class="gk-badge text-xs
                        {% if 'new' in ticket.state|lower %}gk-badge-success
                        {% elif 'open' in ticket.state|lower %}gk-badge-primary
                        {% elif 'pending' in ticket.state|lower %}gk-badge-warning
                        {% elif 'closed' in ticket.state|lower %}gk-badge-muted
                        {% elif 'merged' in ticket.state|lower %}gk-badge-secondary
                        {% else %}gk-badge-muted{% endif %}">
                        {{ ticket.state }}
                    </span>
                </td>
                <td class="px-2 py-2 whitespace-nowrap">
                    <span class="text-xs font-medium" {% if ticket.priority_color %}style="color: {{ ticket.priority_color }}"{% else %}style="color: var(--gk-text-secondary);"{% endif %}>
                        {{ ticket.priority }}
                    </span>
                </td>
                <td class="px-2 py-2 whitespace-nowrap">
                    <div class="text-sm" style="color: var(--gk-text-primary);">
                        {{ ticket.assigned_to|default:"-" }}
                    </div>
                </td>
                <td class="px-2 py-2 text-xs" style="color: var(--gk-text-muted);">
                    {% if ticket.created_at_iso %}<span data-relative-time data-mode="since" data-direction="past" data-timestamp="{{ ticket.created_at_iso }}">{{ ticket.age }}</span>{% else %}{{ ticket.age }}{% endif %}
                </td>
                <td class="px-1 py-2 text-xs text-center" style="color: var(--gk-text-muted);">
                    {{ ticket.article_count }}
                </td>
                <td class="px-1 py-2 text-right">
                    <div class="flex items-center justify-end gap-0.5">
                        <button onclick="quickAssign({{ ticket.id }})" title="{{ t("tooltips.quick_assign")|default:"Quick Assign" }}"
                                class="p-0.5 transition-colors" style="color: var(--gk-text-muted);" onmouseover="this.style.color='var(--gk-primary)'" onmouseout="this.style.color='var(--gk-text-muted)'">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </button>
                        <button onclick="quickPriority({{ ticket.id }})" title="{{ t("tooltips.quick_priority")|default:"Quick Priority" }}"
                                class="p-0.5 transition-colors" style="color: var(--gk-text-muted);" onmouseover="this.style.color='var(--gk-warning)'" onmouseout="this.style.color='var(--gk-text-muted)'">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"></path>
                            </svg>
                        </button>
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="11" class="px-4 py-8 text-center" style="color: var(--gk-text-muted);">
                    {{ t("tickets.no_tickets_found")|default:"No tickets found matching your criteria" }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
